{% extends 'base.html' %}
{% block body %}

<style>

    div#entry {
        margin:1%;
        margin-top:2%;
        margin-bottom:2%;
        padding-top:0.5%;
        padding-bottom:0.5%;
        padding-right:2%;
        padding-left:2%;
        background-color: #b0b0b0;
        border-radius: 10px;
    }

    a:link {
        color: #008989;
        text-decoration: none;
    }

    a:hover {
        text-decoration: underline;
    }

</style>

<div id="results">
    Results from your query "{{ search_text }}" of category "{{ search_type }}"<br>
    
    {% for i in range(length) %}
    
        <div id = "entry">

            <h4><a href = {{ results[i].url }} >{{ results[i].title }}</a></h4> 

            <p>{% for author in authors[i] %}
            <strong>{{ author["last_name"] }}, {{ author["first_name"] }} {{ author["middle_name"] }};</strong>
            {% endfor %}</p>

            <p>{{ results[i].full_desc }}</p>

            <p>{% for desc in descriptors[i] %}
            {{ desc["phrase"] }};
            {% endfor %}</p>

            <form id="form" action="/submit" method="POST">
                <input type="hidden" name="hidden_id" value="{{ publist[i] }}">
                <input id="{{ publist[i] }}" class="vizbutton" type="submit" value="Visualize Data!" name="viz_button"/>
            </form>

        </div>
    
    {% endfor %}

</div>

<script>

    $(function($) {
    $('#results').bind('scroll', function() {
        if($(this).scrollTop() + $(this).innerHeight() >= this.scrollHeight) {
            alert('end reached');
            }
        })
    });

                $.ajax({
                    url: "/update",
                    data: { "pub_id": d.id },
                    success: redrawgraph,
                    dataType: "json"
                });
                    $.ajax({
                    url: "/lazyload",
                    data: { "pub_id": d.id },
                    success: (function(data){ $("#results").append(); }),
                    dataType: "json"
                });

</script>

{% endblock %}